---
title: "Airplane Data Report"
author: "Jimin Lee"
date: "2025-03-16"
output:
  html_document: default
  pdf_document: default
  word_document: default
---
## Import 
```{r}
library(tidyverse)
library(forecast)
library(tseries)
```

### ê¸°ì´ˆ í†µê³„ëŸ‰ ë¶„ì„ 
```{r}
summary(AirPassengers)
```

   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  104.0   180.0   265.5   280.3   360.5   622.0 

```{r}
plot(AirPassengers, main = "Airline Passengers Over Time",
     xlab = "Year-Month", ylab = "Number of Passengers")
```

```{r}
# ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜ 
df <- data.frame(
  year = floor(time(AirPassengers)),  # ì—°ë„ ì¶”ì¶œ
  month = cycle(AirPassengers),  # ì›” ì¶”ì¶œ
  passengers = as.numeric(AirPassengers)  # ìŠ¹ê° ìˆ˜
)

# ì—°ë„ë³„ ë°•ìŠ¤í”Œë¡¯ ìƒì„±
ggplot(df, aes(x = factor(year), y = passengers)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Yearly Boxplot of AirPassengers",
       x = "Year",
       y = "Number of Passengers") +
  theme_minimal()
```
  
1949ë…„ë¶€í„° 1960ë…„ê¹Œì§€ì˜ ë² í–‰ê¸° íƒ‘ìŠ¹ê° ìˆ˜ëŠ” ê°•í•œ ê³„ì ˆì„±ì„ ë„ë©°, ì–‘ì˜ ì¶”ì„¸ë¥¼ ë³´ì¸ë‹¤.  

```{r}
# ì—°ë„ë³„ ë°•ìŠ¤í”Œë¡¯ ìƒì„±
ggplot(df, aes(x = factor(month), y = passengers)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "Monthly Boxplot of AirPassengers",
       x = "Year",
       y = "Number of Passengers") +
  theme_minimal()
```
  
 2ì›”ê³¼ 11ì›”ì— ë¹„í–‰ê¸° íƒ‘ìŠ¹ê°ì˜ ìˆ˜ê°€ ê°€ì¥ ì ì—ˆìœ¼ë©°, 6-8(ì—¬ë¦„)ê¸°ê°„ì—ëŠ” íƒ‘ìŠ¹ê°ì˜ ìˆ˜ê°€ ë§ì•˜ë‹¤.  


## ì‹œê³„ì—´ ë¶„í•´ 
### naive
- ê°€ë²• ëª¨ë¸ 
```{r}
# Decompose the time series
decomposed_additive = decompose(AirPassengers, type="additive")

plot(decomposed_additive)
```
```{r}
random_component <- na.omit(decomposed_additive$random)  # NA ì œê±°

shapiro.test(random_component)  # ì •ê·œì„± ê²€ì •

# ADF (Augmented Dickey-Fuller) Test:
# ê·€ë¬´ê°€ì„¤(H0) â†’ ë¹„ì •ìƒ ì‹œê³„ì—´ ; ëŒ€ë¦½ê°€ì„¤(H1) â†’ ì •ìƒ ì‹œê³„ì—´ 
adf_result <- adf.test(random_component)
cat("ğŸ“Œ ADF ê²€ì • ê²°ê³¼:\n")
print(adf_result)
```
   
   
- ìŠ¹ë²• ëª¨ë¸ 
```{r}
decomposed_multiplicative = decompose(AirPassengers, type="multiplicative")

plot(decomposed_multiplicative)
```
   
   
### STL 
```{r}
plot(stl(AirPassengers, s.window = 12, t.window = 80, t.jump = 5))
```
    
- logë¥¼ ì·¨í•´ ìŠ¹ë²• ëª¨ë¸ì„ ê°€ë²• ëª¨ë¸ë¡œ ë³€í™˜í•¨. 
```{r}
plot(log(AirPassengers), main = "Log Airline Passengers Over Time",
     xlab = "Year-Month", ylab = "Number of Passengers")
```

```{r}
stl_result <- stl(log(AirPassengers), s.window = "periodic", t.window = 80)
plot(stl_result)
```
   
## MA(ì´ë™í‰ê· ) í‰í™œí™” 
```{r}
moving_avg <- stats::filter(AirPassengers, rep(1/12, 12), sides = 2)
plot(AirPassengers, main = "Moving Average Smoothing", col = "blue", lwd = 2)
lines(moving_avg, col = "red", lwd = 2)
legend("topleft", legend = c("Original", "12-Month MA"), col = c("blue", "red"), lwd = 2)

```
  

## ëª¨ë¸ 
### ë°ì´í„° ë‚˜ëˆ„ê¸° 
```{r}
ts_data <- AirPassengers

# í›ˆë ¨(train) ë°ì´í„°: 1949ë…„ ~ 1959ë…„ (ì´ 132ê°œ ì¤‘ 120ê°œ ì‚¬ìš©)
train_data <- window(ts_data, end = c(1959, 12))

# í…ŒìŠ¤íŠ¸(test) ë°ì´í„°: 1960ë…„ (ë§ˆì§€ë§‰ 12ê°œì›” ì˜ˆì¸¡ í‰ê°€)
test_data <- window(ts_data, start = c(1960, 1))
```

### PACF ì‹œê°í™” 
```{r}
Pacf(AirPassengers, main = "PACF of AirPassengers", col = "blue", lwd = 2)
```
   
13ì¼ë•Œ PACF ê°’ì´ í¬ê¸° ë•Œë¬¸ì—, AR(13) ì ì ˆ 

### AR (ìê°€íšŒê·€)ëª¨ë¸ 

```{r}
#  MA (Moving Average) ëª¨ë¸ 
ma_model <- arima(train_data, order = c(0, 0, 13))  # MA(1) ëª¨ë¸
ma_forecast <- forecast(ma_model, h = 12)

# ì‹œê°í™”: ì „ì²´ ë°ì´í„° í¬í•¨
plot(ts_data, type = "l", col = "black", lwd = 2, ylim = range(ts_data, ma_forecast$mean),
     main = "MA vs AR Model Forecast",
     xlab = "Year", ylab = "Number of Passengers")

# MA ëª¨ë¸ ì˜ˆì¸¡ê°’ ì¶”ê°€
lines(ma_forecast$mean, col = "blue", lwd = 2, lty = 2)
 
# ë²”ë¡€ ì¶”ê°€
legend("topleft",
       legend = c("Actual Data", "MA Forecast"),
       col = c("black", "blue"),
       lwd = 2, lty = c(1, 2, 2))
```
  
p=1ë¡œ ê³ ì •í•œ ë²„ì „ì€ ì œëŒ€ë¡œ ê³„ì ˆì„±ë„, ì¶”ì„¸ë„ ì˜ ë°˜ì˜í•˜ì§€ ëª»í–ˆë‹¤. 

```{r}
ar_model <- ar(train_data)

# 3ï¸âƒ£ 12ê°œì›” ì˜ˆì¸¡ ìˆ˜í–‰
ar_pred <- predict(ar_model, n.ahead = 12)

# 4ï¸âƒ£ ì‹œê°í™”: ì „ì²´ ë°ì´í„° í¬í•¨í•˜ì—¬ ì˜ˆì¸¡ ë¹„êµ
plot(ts_data, type = "l", col = "black", lwd = 2, ylim = range(ts_data, ar_pred$pred),
     main = "AR Model Forecast",
     xlab = "Year", ylab = "Number of Passengers")

# AR ì˜ˆì¸¡ê°’ ì¶”ê°€ (ë¹¨ê°„ ì ì„ )
lines(1960 + (1:12)/12, ar_pred$pred, col = "red", lwd = 2, lty = 2)

# í…ŒìŠ¤íŠ¸ ë°ì´í„° (ì‹¤ì œê°’) ì¶”ê°€ (íŒŒë€ ì‹¤ì„ )
lines(test_data, col = "blue", lwd = 2)

# ë²”ë¡€ ì¶”ê°€
legend("topleft",
       legend = c("Actual Data", "Test Data", "AR Forecast"),
       col = c("black", "blue", "red"),
       lwd = 2, lty = c(1, 1, 2))
```


### ARIMA 
```{r}
# ARIMA ëª¨ë¸ ì í•©
arima_model <- auto.arima(train_data, seasonal = FALSE)
summary(arima_model)

# 12ê°œì›” ì˜ˆì¸¡ ìˆ˜í–‰
arima_forecast <- forecast(arima_model, h = 12)

# ì˜ˆì¸¡ ê²°ê³¼ ì‹œê°í™”
plot(arima_forecast, main = "ARIMA Model Forecast vs Actual", col = "blue", lwd = 2)
lines(test_data, col = "red", lwd = 2)  # ì‹¤ì œê°’ ì¶”ê°€
legend("topleft", legend = c("ARIMA Forecast", "Actual"), col = c("blue", "red"), lwd = 2)
```
   
### SARIMA 
```{r}
# ê³„ì ˆì„± í¬í•¨ëœ SARIMA ëª¨ë¸ ì í•©
sarima_model <- auto.arima(train_data, seasonal = TRUE)
summary(sarima_model)

# 12ê°œì›” ì˜ˆì¸¡ ìˆ˜í–‰
sarima_forecast <- forecast(sarima_model, h = 12)

# ì˜ˆì¸¡ ê²°ê³¼ ì‹œê°í™”
plot(sarima_forecast, main = "SARIMA Model Forecast vs Actual", col = "blue", lwd = 2)
lines(test_data, col = "red", lwd = 2)  # ì‹¤ì œê°’ ì¶”ê°€
legend("topleft", legend = c("SARIMA Forecast", "Actual"), col = c("blue", "red"), lwd = 2)
```

  
 ARIMAì™€ SARIMAë¥¼ ë¹„êµì— ì‚¬ìš©í•œ ì§€í‘œ   
  MAPE(Mean Absolute Percentage Error). 
	â€¢	ë‚®ì„ìˆ˜ë¡ ë” ì¢‹ì€ ëª¨ë¸.     
	â€¢	ì¼ë°˜ì ìœ¼ë¡œ MAPE < 10% â†’ ë§¤ìš° ì •í™•í•¨, 10~20% â†’ ì–‘í˜¸í•¨.  
	
  RMSE (Root Mean Squared Error).  
	â€¢	ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì˜ ì°¨ì´(ì˜¤ì°¨)ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œ.  
	â€¢	ê°’ì´ ë‚®ì„ìˆ˜ë¡ ì˜ˆì¸¡ì´ ì •í™•í•¨      
	
	
| ì§€í‘œ | ARIMA | SARIMA | 
| - | - | - | 
| MAPE | 9.647887 % | 4.182395 % | 
| RMSE | 53.359  | 23.9317 | 

ARIMA ë°©ë²•ë¡ ë„ ë‹¤ë¥¸ AR,MA ë°©ë²•ë¡ ì— ë¹„í•´ ê³„ì ˆì„±ê³¼ ì¶”ì„¸ë¥¼ ì˜ í¬ì°©í•œë‹¤. í•˜ì§€ë§Œ ì‹œê°í™”ë¡œ ë³´ë‚˜ ìˆ˜ì¹˜ì  ì§€í‘œë¡œ ë³´ë‚˜ SARIMAê°€ ë” ì¢‹ì€ ëª¨ë¸ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤. 